---
title: "5. Calculate carbon results from FVS output - Reforestation"
author: "Carmen Tubbesing"
date: "`r Sys.Date()`"
format: 
  html:
    embed-resources: TRUE
    toc: TRUE
---

# This run is for project `FY23-24_8GG23626_American_Forests`
## TCN = `3&4`

# Setup
```{r, include = F}
require(tidyverse)
require(readxl)
require(ggplot2)
```

## Set the acreage of your reforestation treatment
```{r}
area_ac <- 400
```

### Set the end year when carbon should be tallied
```{r}
end_yr <- 2105
```


## Define folder where the FVS outputs are located
*Note:* Replace this for the file folder on your computer
```{r}
fvs_output_dir = "~/../../Data_heavy_projects/Forest_QM_automation/FVS_Output"
```

## Load the FVS output files
```{r}
df <- read_excel(paste0(fvs_output_dir, "/8GG23636_RF1_M1PL.xlsx"))
```

```{r}
df_means <- df %>% 
  group_by(Year) %>% 
  summarize(Aboveground_Total_Live = mean(Aboveground_Total_Live)) 
df_means <- df_means %>% 
  ungroup()
```


```{r}
ggplot(df_means) +
  geom_point(aes(x = Year, y = Aboveground_Total_Live)) +
  labs(
    y = "Live Aboveground Carbon (C)") +
  theme_minimal()
```


# Filter to last year of project
```{r}
df <- df %>% 
  filter(Year == end_yr)
```

# Multiply by acres and calculate results
-  Calculate total ending year carbon for each scenario
-  Print results in the order they appear in `FRM_Calculator_Tool`
```{r}
df <- df%>% 
  mutate(Total_C = (Aboveground_Total_Live + Belowground_Live + Belowground_Dead + Standing_Dead) * area_ac)

# Sum carbon and label it
sum <- sum(df$Total_C)

print(paste("total C =", round(sum, 0), "MTC"))
```

